{"version":3,"sources":["../../../src/Apps/Artwork/ArtworkApp.tsx"],"names":["ArtworkApp","trackPageview","trackProductView","props","tracking","artwork","is_acquireable","is_in_auction","_id","trackingData","action_type","Schema","ActionType","ViewedProduct","product_id","trackEvent","mediator","is_offerable","trigger","price","availability","properties","path","window","location","pathname","acquireable","offerable","price_listed","analytics","page","integrations","Marketo","artists","p","length","map","artist","index","addSpacer","id","renderArtists","enableIntercomForBuyers","React","Component","ArtworkAppFragmentContainer"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAKA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IASaA,U,WADZ,uB;;;;;;;;;;;;;AAEC;AACA;AACA;AACA;AACA;AACA;wCACoB;AAClB,WAAKC,aAAL;AACA,WAAKC,gBAAL;AACD;;;uCAEkB;AAAA,wBAIb,KAAKC,KAJQ;AAAA,UAEfC,QAFe,eAEfA,QAFe;AAAA,4CAGfC,OAHe;AAAA,UAGJC,cAHI,uBAGJA,cAHI;AAAA,UAGYC,aAHZ,uBAGYA,aAHZ;AAAA,UAG2BC,GAH3B,uBAG2BA,GAH3B;;AAMjB,UAAIF,cAAc,IAAIC,aAAtB,EAAqC;AACnC,YAAME,YAAY,GAAG;AACnBC,UAAAA,WAAW,EAAEC,MAAM,CAACC,UAAP,CAAkBC,aADZ;AAEnBC,UAAAA,UAAU,EAAEN;AAFO,SAArB;AAIA,YAAIJ,QAAJ,EAAcA,QAAQ,CAACW,UAAT,CAAoBN,YAApB;AACf;AACF;;;4CAEuBO,Q,EAAU;AAAA,iCAG5B,KAAKb,KAHuB,CAE9BE,OAF8B;AAAA,UAEnBY,YAFmB,wBAEnBA,YAFmB;AAAA,UAELX,cAFK,wBAELA,cAFK;AAIhCU,MAAAA,QAAQ,IACNA,QAAQ,CAACE,OADX,IAEEF,QAAQ,CAACE,OAAT,CAAiB,yBAAjB,EAA4C;AAC1CD,QAAAA,YAAY,EAAZA,YAD0C;AAE1CX,QAAAA,cAAc,EAAdA;AAF0C,OAA5C,CAFF;AAMD;;;oCAEe;AAAA,iCAGV,KAAKH,KAHK,CAEZE,OAFY;AAAA,UAEDc,KAFC,wBAEDA,KAFC;AAAA,UAEMC,YAFN,wBAEMA,YAFN;AAAA,UAEoBH,YAFpB,wBAEoBA,YAFpB;AAAA,UAEkCX,cAFlC,wBAEkCA,cAFlC,EAKd;;AACA,UAAMe,UAAU,GAAG;AACjBC,QAAAA,IAAI,EAAEC,MAAM,CAACC,QAAP,CAAgBC,QADL;AAEjBC,QAAAA,WAAW,EAAEpB,cAFI;AAGjBqB,QAAAA,SAAS,EAAEV,YAHM;AAIjBG,QAAAA,YAAY,EAAZA,YAJiB;AAKjBQ,QAAAA,YAAY,EAAE,CAAC,CAACT;AALC,OAAnB;;AAQA,UAAI,OAAOI,MAAM,CAACM,SAAd,KAA4B,WAAhC,EAA6C;AAC3CN,QAAAA,MAAM,CAACM,SAAP,CAAiBC,IAAjB,CAAsBT,UAAtB,EAAkC;AAAEU,UAAAA,YAAY,EAAE;AAAEC,YAAAA,OAAO,EAAE;AAAX;AAAhB,SAAlC;AACD;AACF;;;oCAEe;AACd,UAAMC,OAAO,GAAG,cAAI,KAAK9B,KAAT,EAAgB,UAAA+B,CAAC;AAAA,eAAIA,CAAC,CAAC7B,OAAF,CAAU4B,OAAd;AAAA,OAAjB,CAAhB;;AAEA,UAAI,CAACA,OAAO,CAACE,MAAb,EAAqB;AACnB,eAAO,IAAP;AACD;;AAED,aACE,4DACGF,OAAO,CAACG,GAAR,CAAY,UAACC,MAAD,EAASC,KAAT,EAAmB;AAC9B,YAAMC,SAAS,GAAGN,OAAO,CAACE,MAAR,GAAiB,CAAjB,IAAsBG,KAAK,GAAGL,OAAO,CAACE,MAAR,GAAiB,CAAjE;AACA,eACE,6BAAC,cAAD,CAAO,QAAP;AAAgB,UAAA,GAAG,EAAEG;AAArB,WACE,6BAAC,YAAD;AAAK,UAAA,GAAG,EAAED,MAAM,CAACG;AAAjB,WACE,6BAAC,YAAD,QACE,6BAAC,uCAAD;AAAY,UAAA,MAAM,EAAEH;AAApB,UADF,CADF,CADF,EAMGE,SAAS,IAAI,6BAAC,eAAD;AAAQ,UAAA,EAAE,EAAE;AAAZ,UANhB,CADF;AAUD,OAZA,CADH,CADF;AAiBD;;;6BAEQ;AAAA;;AAAA,UACClC,OADD,GACa,KAAKF,KADlB,CACCE,OADD;AAGP,aACE,6BAAC,0BAAD,QACE,6BAAC,oCAAD,QAEE,6BAAC,yCAAD;AAAa,QAAA,OAAO,EAAEA;AAAtB,QAFF,EAIE,6BAAC,YAAD,QACE,6BAAC,YAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,6BAAC,6CAAD;AAAe,QAAA,OAAO,EAAEA;AAAxB,QADF,EAEE,6BAAC,eAAD;AAAQ,QAAA,EAAE,EAAE;AAAZ,QAFF,CADF,CAJF,EAYE,6BAAC,iBAAD;AAAO,QAAA,EAAE,EAAC;AAAV,SACE,6BAAC,YAAD,QACE,6BAAC,YAAD,QACE,6BAAC,yDAAD;AAAqB,QAAA,OAAO,EAAEA;AAA9B,QADF,EAEE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEA;AAAzB,QAFF,EAGE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEA;AAAzB,QAHF,EAIE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEA;AAAzB,QAJF,EAKG,KAAKoC,aAAL,EALH,CADF,CADF,CAZF,EAyBE,6BAAC,iBAAD;AAAO,QAAA,WAAW,EAAC;AAAnB,SACE,6BAAC,YAAD,QACE,6BAAC,YAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,6BAAC,YAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,6BAAC,yDAAD;AAAqB,QAAA,OAAO,EAAEpC;AAA9B,QADF,EAEE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEA;AAAzB,QAFF,EAGE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEA;AAAzB,QAHF,EAIG,KAAKoC,aAAL,EAJH,CADF,CADF,EASE,6BAAC,YAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,6BAAC,+CAAD;AAAgB,QAAA,OAAO,EAAEpC;AAAzB,QADF,CATF,CADF,CAzBF,EAyCE,6BAAC,YAAD,QACE,6BAAC,YAAD,QACE,6BAAC,YAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,6BAAC,uCAAD;AAAY,QAAA,OAAO,EAAEA;AAArB,QADF,CADF,CADF,CAzCF,EAiDGA,OAAO,CAACgC,MAAR,IACC,6BAAC,YAAD,QACE,6BAAC,YAAD,QACE,6BAAC,+DAAD;AAAgB,QAAA,OAAO,EAAEhC;AAAzB,QADF,CADF,CAlDJ,EAyDG,OAAOkB,MAAP,KAAkB,WAAlB,IACC,6BAAC,8CAAD;AAAmB,QAAA,SAAS,EAAE;AAA9B,SACE,6BAAC,YAAD,QACE,6BAAC,YAAD,QACE,6BAAC,8BAAD,OADF,CADF,CADF,CA1DJ,EAmEE,6BAAC,YAAD,QACE,6BAAC,YAAD,QACE,6BAAC,kBAAD;AAAW,QAAA,EAAE,EAAE,CAAf;AAAkB,QAAA,EAAE,EAAE;AAAtB,QADF,EAEE,6BAAC,SAAD,OAFF,CADF,CAnEF,EA0EE;AAAK,QAAA,EAAE,EAAC;AAAR,QA1EF,EA2EE,6BAAC,4BAAD,QACG;AAAA,YAAGP,QAAH,QAAGA,QAAH;AAAA,eAAkB,4DAAG,KAAI,CAAC0B,uBAAL,CAA6B1B,QAA7B,CAAH,CAAlB;AAAA,OADH,CA3EF,CADF,CADF;AAmFD;;;;EA1K6B2B,eAAMC,S;;AA6K/B,IAAMC,2BAA2B,GAAG,yCAAwB7C,UAAxB,EAAoC;AAC7EK,EAAAA,OAAO;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADsE,CAApC,CAApC","sourcesContent":["import { Box, Col, Row, Separator, Spacer } from \"@artsy/palette\"\nimport React from \"react\"\nimport { LazyLoadComponent } from \"react-lazy-load-image-component\"\nimport { createFragmentContainer, graphql } from \"react-relay\"\n\nimport { ArtworkApp_artwork } from \"__generated__/ArtworkApp_artwork.graphql\"\nimport { AppContainer } from \"Apps/Components/AppContainer\"\nimport { HorizontalPadding } from \"Apps/Components/HorizontalPadding\"\n\nimport { ArtistInfoFragmentContainer as ArtistInfo } from \"./Components/ArtistInfo\"\nimport { ArtworkBannerFragmentContainer as ArtworkBanner } from \"./Components/ArtworkBanner\"\nimport { ArtworkDetailsFragmentContainer as ArtworkDetails } from \"./Components/ArtworkDetails\"\nimport { ArtworkImageBrowserFragmentContainer as ArtworkImageBrowser } from \"./Components/ArtworkImageBrowser\"\nimport { ArtworkMetaFragmentContainer as ArtworkMeta } from \"./Components/ArtworkMeta\"\nimport { ArtworkRelatedArtistsPaginationContainer as RelatedArtists } from \"./Components/ArtworkRelatedArtists\"\nimport { ArtworkSidebarFragmentContainer as ArtworkSidebar } from \"./Components/ArtworkSidebar\"\nimport { OtherWorksFragmentContainer as OtherWorks } from \"./Components/OtherWorks\"\nimport { PricingContextFragmentContainer as PricingContext } from \"./Components/PricingContext\"\n\nimport { SystemContextConsumer } from \"Artsy\"\nimport { track } from \"Artsy/Analytics\"\nimport * as Schema from \"Artsy/Analytics/Schema\"\nimport {\n  Footer,\n  RecentlyViewedQueryRenderer as RecentlyViewed,\n} from \"Components/v2\"\nimport { TrackingProp } from \"react-tracking\"\nimport { get } from \"Utils/get\"\nimport { Media } from \"Utils/Responsive\"\n\nexport interface Props {\n  artwork: ArtworkApp_artwork\n  tracking?: TrackingProp\n}\n\ndeclare const window: any\n@track()\nexport class ArtworkApp extends React.Component<Props> {\n  // TODO: Move the below tracking, which consists of:\n  //\n  //  * a custom `track` event when the artwork is acquireable or in an auction\n  //  * a custom pageview event including extra metadata\n  //\n  // into an appropriate wrapper HOC.\n  componentDidMount() {\n    this.trackPageview()\n    this.trackProductView()\n  }\n\n  trackProductView() {\n    const {\n      tracking,\n      artwork: { is_acquireable, is_in_auction, _id },\n    } = this.props\n\n    if (is_acquireable || is_in_auction) {\n      const trackingData = {\n        action_type: Schema.ActionType.ViewedProduct,\n        product_id: _id,\n      }\n      if (tracking) tracking.trackEvent(trackingData)\n    }\n  }\n\n  enableIntercomForBuyers(mediator) {\n    const {\n      artwork: { is_offerable, is_acquireable },\n    } = this.props\n    mediator &&\n      mediator.trigger &&\n      mediator.trigger(\"enableIntercomForBuyers\", {\n        is_offerable,\n        is_acquireable,\n      })\n  }\n\n  trackPageview() {\n    const {\n      artwork: { price, availability, is_offerable, is_acquireable },\n    } = this.props\n\n    // Pageview\n    const properties = {\n      path: window.location.pathname,\n      acquireable: is_acquireable,\n      offerable: is_offerable,\n      availability,\n      price_listed: !!price,\n    }\n\n    if (typeof window.analytics !== \"undefined\") {\n      window.analytics.page(properties, { integrations: { Marketo: false } })\n    }\n  }\n\n  renderArtists() {\n    const artists = get(this.props, p => p.artwork.artists)\n\n    if (!artists.length) {\n      return null\n    }\n\n    return (\n      <>\n        {artists.map((artist, index) => {\n          const addSpacer = artists.length > 1 && index < artists.length - 1\n          return (\n            <React.Fragment key={index}>\n              <Row key={artist.id}>\n                <Col>\n                  <ArtistInfo artist={artist} />\n                </Col>\n              </Row>\n              {addSpacer && <Spacer mb={2} />}\n            </React.Fragment>\n          )\n        })}\n      </>\n    )\n  }\n\n  render() {\n    const { artwork } = this.props\n\n    return (\n      <AppContainer>\n        <HorizontalPadding>\n          {/* NOTE: react-head automatically moves these tags to the <head> element */}\n          <ArtworkMeta artwork={artwork} />\n\n          <Row>\n            <Col sm={8}>\n              <ArtworkBanner artwork={artwork} />\n              <Spacer mb={2} />\n            </Col>\n          </Row>\n\n          {/* Mobile */}\n          <Media at=\"xs\">\n            <Row>\n              <Col>\n                <ArtworkImageBrowser artwork={artwork} />\n                <ArtworkSidebar artwork={artwork} />\n                <ArtworkDetails artwork={artwork} />\n                <PricingContext artwork={artwork} />\n                {this.renderArtists()}\n              </Col>\n            </Row>\n          </Media>\n\n          {/* Desktop */}\n          <Media greaterThan=\"xs\">\n            <Row>\n              <Col sm={8}>\n                <Box pr={4}>\n                  <ArtworkImageBrowser artwork={artwork} />\n                  <ArtworkDetails artwork={artwork} />\n                  <PricingContext artwork={artwork} />\n                  {this.renderArtists()}\n                </Box>\n              </Col>\n              <Col sm={4}>\n                <ArtworkSidebar artwork={artwork} />\n              </Col>\n            </Row>\n          </Media>\n\n          <Row>\n            <Col>\n              <Box mt={6}>\n                <OtherWorks artwork={artwork} />\n              </Box>\n            </Col>\n          </Row>\n\n          {artwork.artist && (\n            <Row>\n              <Col>\n                <RelatedArtists artwork={artwork} />\n              </Col>\n            </Row>\n          )}\n\n          {typeof window !== \"undefined\" && (\n            <LazyLoadComponent threshold={1000}>\n              <Row>\n                <Col>\n                  <RecentlyViewed />\n                </Col>\n              </Row>\n            </LazyLoadComponent>\n          )}\n\n          <Row>\n            <Col>\n              <Separator mt={6} mb={3} />\n              <Footer />\n            </Col>\n          </Row>\n\n          <div id=\"lightbox-container\" />\n          <SystemContextConsumer>\n            {({ mediator }) => <>{this.enableIntercomForBuyers(mediator)}</>}\n          </SystemContextConsumer>\n        </HorizontalPadding>\n      </AppContainer>\n    )\n  }\n}\n\nexport const ArtworkAppFragmentContainer = createFragmentContainer(ArtworkApp, {\n  artwork: graphql`\n    fragment ArtworkApp_artwork on Artwork {\n      id\n      _id\n      is_acquireable\n      is_offerable\n      availability\n      price\n      is_in_auction\n      artists {\n        id\n        ...ArtistInfo_artist\n      }\n      artist {\n        ...ArtistInfo_artist\n      }\n      ...ArtworkRelatedArtists_artwork\n      ...ArtworkMeta_artwork\n      ...ArtworkBanner_artwork\n      ...ArtworkSidebar_artwork\n      ...ArtworkDetails_artwork\n      ...ArtworkImageBrowser_artwork\n      ...OtherWorks_artwork\n      ...PricingContext_artwork\n    }\n  `,\n})\n"],"file":"ArtworkApp.js"}