{"version":3,"sources":["../../../../../src/Apps/Artwork/Components/ArtworkImageBrowser/ArtworkSharePanel.tsx"],"names":["MODAL","width","height","COPY_LABELS","copy","copied","ArtworkSharePanel","copyLabelText","copyLocked","state","input","focus","setSelectionRange","value","length","document","execCommand","setState","setTimeout","service","url","event","preventDefault","wLeft","window","screenLeft","screenX","wTop","screenTop","screenY","left","innerWidth","top","innerHeight","options","Object","entries","status","map","key","join","open","label","message","openShareModal","props","artwork","href","share","artworkMeta","images","shareImageUrl","sd","APP_URL","onClose","handleCopy","renderShareButton","React","Component","ArtworkSharePanelFragmentContainer","SansGrow","Sans","URLInput","styled","media","xs","UnstyledLink","a"],"mappings":"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","sourcesContent":["import { color, Flex, media, Sans, Separator } from \"@artsy/palette\"\nimport { ArtworkSharePanel_artwork } from \"__generated__/ArtworkSharePanel_artwork.graphql\"\nimport Icon from \"Components/Icon\"\nimport React from \"react\"\nimport { createFragmentContainer, graphql } from \"react-relay\"\nimport { data as sd } from \"sharify\"\nimport styled from \"styled-components\"\nimport { ArtworkPopoutPanel } from \"./ArtworkPopoutPanel\"\n\ninterface ArtworkSharePanelProps {\n  artwork: ArtworkSharePanel_artwork\n  onClose: () => void\n}\n\ninterface ArtworkSharePanelState {\n  copyLabelText: string\n  copyLocked: boolean\n}\n\nconst MODAL = {\n  width: 750,\n  height: 400,\n}\n\nconst COPY_LABELS = {\n  copy: \"Copy\",\n  copied: \"Copied\",\n}\n\nexport class ArtworkSharePanel extends React.Component<\n  ArtworkSharePanelProps,\n  ArtworkSharePanelState\n> {\n  private input: HTMLInputElement\n\n  state = {\n    copyLabelText: COPY_LABELS.copy,\n    copyLocked: false,\n  }\n\n  handleCopy = () => {\n    if (!this.state.copyLocked) {\n      this.input.focus()\n      this.input.setSelectionRange(0, this.input.value.length)\n      document.execCommand(\"copy\")\n\n      this.setState(\n        {\n          copyLabelText: COPY_LABELS.copied,\n          copyLocked: true,\n        },\n        () => {\n          setTimeout(() => {\n            this.setState({\n              copyLabelText: COPY_LABELS.copy,\n              copyLocked: false,\n            })\n          }, 500)\n        }\n      )\n    }\n  }\n\n  openShareModal = ({ service, url }) => event => {\n    event.preventDefault()\n\n    // Extracted from https://github.com/artsy/force/blob/master/src/desktop/components/share/view.coffee#L19\n    const wLeft = window.screenLeft || window.screenX\n    const wTop = window.screenTop || window.screenY\n    const width = MODAL.width\n    const height = MODAL.height\n    const left = wLeft + window.innerWidth / 2 - width / 2 || 0\n    const top = wTop + window.innerHeight / 2 - height / 2 || 0\n\n    const options = Object.entries({\n      status: 1,\n      width,\n      height,\n      top,\n      left,\n    })\n      .map(([key, value]) => `${key}=${value}`)\n      .join(\",\")\n\n    window.open(url, service, options)\n  }\n\n  renderShareButton({ service, label, message, url }) {\n    return (\n      <Flex\n        flexDirection=\"row\"\n        flexBasis=\"50%\"\n        mt={2}\n        onClick={this.openShareModal({\n          service,\n          url,\n        })}\n      >\n        <Icon name={service} color=\"black\" />\n        <Sans size=\"3\" color=\"black60\">\n          <a>{label}</a>\n        </Sans>\n      </Flex>\n    )\n  }\n\n  render() {\n    const {\n      artwork: {\n        href,\n        artworkMeta: { share },\n        images,\n      },\n    } = this.props\n\n    const shareImageUrl = images && images[0].url\n    const url = sd.APP_URL + href\n\n    return (\n      <ArtworkPopoutPanel title=\"Share\" onClose={this.props.onClose}>\n        <Flex flexDirection=\"row\" mb={1}>\n          <SansGrow size={[\"3\", \"2\"]} color=\"black60\" mr={4}>\n            <URLInput\n              type=\"text\"\n              readOnly\n              value={url}\n              ref={input => (this.input = input)}\n              onClick={this.handleCopy}\n            />\n          </SansGrow>\n          <Sans size={[\"3\", \"2\"]} weight=\"medium\" color=\"black60\">\n            <a onClick={this.handleCopy}>{this.state.copyLabelText}</a>\n          </Sans>\n        </Flex>\n        <Separator />\n        <Flex flexDirection=\"row\" flexWrap=\"wrap\">\n          {this.renderShareButton({\n            service: \"facebook\",\n            label: \"Facebook\",\n            message: \"Post to Facebook\",\n            url: `https://www.facebook.com/sharer/sharer.php?u=${url}`,\n          })}\n          {this.renderShareButton({\n            service: \"twitter\",\n            label: \"Twitter\",\n            message: \"Share on Twitter\",\n            url: `https://twitter.com/intent/tweet?original_referer=${url}&text=${share}&url=${url}&via=artsy`,\n          })}\n\n          {/*\n              NOTE: Safari requires direct user interaction.\n              See: https://developer.apple.com/safari/technology-preview/release-notes/#r15\n            */}\n          <Flex flexDirection=\"row\" flexBasis=\"50%\" mt={2}>\n            <Icon name=\"mail\" color=\"black\" />\n            <Sans size=\"3\" color=\"black60\">\n              <UnstyledLink\n                href={`mailto:?subject=${share}&body=${share} on Artsy: ${url}`}\n              >\n                Mail\n              </UnstyledLink>\n            </Sans>\n          </Flex>\n\n          {this.renderShareButton({\n            service: \"pinterest\",\n            label: \"Pinterest\",\n            message: \"Pin It on Pinterest\",\n            url: `https://pinterest.com/pin/create/button/?url=${url}&media=${shareImageUrl}&description=${share}`,\n          })}\n          {this.renderShareButton({\n            service: \"tumblr\",\n            label: \"Tumblr\",\n            message: \"\",\n            url: `https://www.tumblr.com/share/photo?source=${shareImageUrl}&caption=${share}&clickthru=${url}`,\n          })}\n        </Flex>\n      </ArtworkPopoutPanel>\n    )\n  }\n}\n\nexport const ArtworkSharePanelFragmentContainer = createFragmentContainer(\n  ArtworkSharePanel,\n  {\n    artwork: graphql`\n      fragment ArtworkSharePanel_artwork on Artwork {\n        href\n        images {\n          url\n        }\n        artworkMeta: meta {\n          share\n        }\n      }\n    `,\n  }\n)\n\nconst SansGrow = styled(Sans)`\n  display: flex;\n  flex-grow: 1;\n`\n\nconst URLInput = styled.input`\n  border: 0;\n  text-overflow: ellipsis;\n  display: flex;\n  flex-grow: 1;\n  color: inherit;\n  font-family: Arial, Helvetica, sans-serif;\n\n  ${media.xs`\n    font-size: 16px;\n  `};\n\n  &:hover {\n    color: ${color(\"black100\")};\n  }\n\n  &::selection {\n    color: ${color(\"white100\")};\n    background: ${color(\"purple100\")};\n  }\n`\n\nconst UnstyledLink = styled.a`\n  text-decoration: none;\n\n  &:hover {\n    text-decoration: none;\n  }\n`\n"],"file":"ArtworkSharePanel.js"}