{"version":3,"sources":["../../../../../src/Apps/Order/Routes/Reject/index.tsx"],"names":["Reject","rejectOffer","input","offerId","props","order","lastOffer","id","orderOrError","commerceBuyerRejectOffer","error","router","push","logger","dialog","showErrorDialog","variables","commitMutation","mutation","isCommittingMutation","counterofferFlowSteps","pointerEvents","createdAt","stateExpiresAt","onChangeResponse","onSubmit","Component","RejectFragmentContainer"],"mappings":"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","sourcesContent":["import { Button, Col, Flex, Row, Sans, Spacer } from \"@artsy/palette\"\nimport { Reject_order } from \"__generated__/Reject_order.graphql\"\nimport { RejectOfferMutation } from \"__generated__/RejectOfferMutation.graphql\"\nimport { ArtworkSummaryItemFragmentContainer as ArtworkSummaryItem } from \"Apps/Order/Components/ArtworkSummaryItem\"\nimport { ConditionsOfSaleDisclaimer } from \"Apps/Order/Components/ConditionsOfSaleDisclaimer\"\nimport { TwoColumnLayout } from \"Apps/Order/Components/TwoColumnLayout\"\nimport { trackPageViewWrapper } from \"Apps/Order/Utils/trackPageViewWrapper\"\nimport { Router } from \"found\"\nimport React, { Component } from \"react\"\n\nimport { HorizontalPadding } from \"Apps/Components/HorizontalPadding\"\nimport { StepSummaryItem } from \"Components/v2\"\nimport { CountdownTimer } from \"Components/v2/CountdownTimer\"\nimport { Media } from \"Utils/Responsive\"\nimport { logger } from \"../Respond\"\n\nimport {\n  counterofferFlowSteps,\n  OrderStepper,\n} from \"Apps/Order/Components/OrderStepper\"\n\nimport { Dialog, injectDialog } from \"Apps/Order/Dialogs\"\nimport {\n  CommitMutation,\n  injectCommitMutation,\n} from \"Apps/Order/Utils/commitMutation\"\nimport { createFragmentContainer, graphql, RelayProp } from \"react-relay\"\n\ninterface RejectProps {\n  order: Reject_order\n  relay?: RelayProp\n  router: Router\n  dialog: Dialog\n  commitMutation: CommitMutation\n  isCommittingMutation: boolean\n}\n\nexport class Reject extends Component<RejectProps> {\n  rejectOffer(variables: RejectOfferMutation[\"variables\"]) {\n    return this.props.commitMutation<RejectOfferMutation>({\n      variables,\n      mutation: graphql`\n        mutation RejectOfferMutation($input: CommerceBuyerRejectOfferInput!) {\n          commerceBuyerRejectOffer(input: $input) {\n            orderOrError {\n              ... on CommerceOrderWithMutationSuccess {\n                __typename\n                order {\n                  id\n                  ... on CommerceOfferOrder {\n                    awaitingResponseFrom\n                  }\n                }\n              }\n              ... on CommerceOrderWithMutationFailure {\n                error {\n                  type\n                  code\n                  data\n                }\n              }\n            }\n          }\n        }\n      `,\n    })\n  }\n\n  onSubmit = async () => {\n    try {\n      const orderOrError = (await this.rejectOffer({\n        input: {\n          offerId: this.props.order.lastOffer.id,\n        },\n      })).commerceBuyerRejectOffer.orderOrError\n\n      if (orderOrError.error) {\n        throw orderOrError.error\n      }\n\n      this.props.router.push(`/orders/${this.props.order.id}/status`)\n    } catch (error) {\n      logger.error(error)\n      this.props.dialog.showErrorDialog()\n    }\n  }\n\n  onChangeResponse = () => {\n    const { order } = this.props\n    this.props.router.push(`/orders/${order.id}/respond`)\n  }\n\n  render() {\n    const { order, isCommittingMutation } = this.props\n\n    return (\n      <>\n        <HorizontalPadding px={[0, 4]}>\n          <Row>\n            <Col>\n              <OrderStepper\n                currentStep=\"Review\"\n                steps={counterofferFlowSteps}\n              />\n            </Col>\n          </Row>\n        </HorizontalPadding>\n        <HorizontalPadding>\n          <TwoColumnLayout\n            Content={\n              <Flex\n                flexDirection=\"column\"\n                style={isCommittingMutation ? { pointerEvents: \"none\" } : {}}\n              >\n                <Media at=\"xs\">\n                  <Flex flexDirection=\"column\">\n                    <ArtworkSummaryItem order={order} />\n                  </Flex>\n                  <Spacer mb={2} />\n                </Media>\n                <Flex flexDirection=\"column\">\n                  <CountdownTimer\n                    action=\"Respond\"\n                    note=\"Expired offers end the negotiation process permanently.\"\n                    countdownStart={order.lastOffer.createdAt}\n                    countdownEnd={order.stateExpiresAt}\n                  />\n                  <StepSummaryItem\n                    title=\"Decline seller's offer\"\n                    onChange={this.onChangeResponse}\n                  >\n                    <Sans size=\"2\" color=\"black60\">\n                      Declining an offer permanently ends the negotiation\n                      process. The seller will not be able to make a\n                      counteroffer.\n                    </Sans>\n                  </StepSummaryItem>\n                </Flex>\n                <Spacer mb={[2, 3]} />\n                <Media greaterThan=\"xs\">\n                  <Button\n                    onClick={this.onSubmit}\n                    loading={isCommittingMutation}\n                    size=\"large\"\n                    width=\"100%\"\n                  >\n                    Submit\n                  </Button>\n                  <Spacer mb={2} />\n                  <ConditionsOfSaleDisclaimer textAlign=\"center\" />\n                </Media>\n              </Flex>\n            }\n            Sidebar={\n              <Flex flexDirection=\"column\">\n                <Media greaterThan=\"xs\">\n                  <Flex flexDirection=\"column\">\n                    <ArtworkSummaryItem order={order} />\n                  </Flex>\n                  <Spacer mb={2} />\n                </Media>\n                <Media at=\"xs\">\n                  <>\n                    <Button\n                      onClick={this.onSubmit}\n                      loading={isCommittingMutation}\n                      size=\"large\"\n                      width=\"100%\"\n                    >\n                      Submit\n                    </Button>\n                    <Spacer mb={2} />\n                    <ConditionsOfSaleDisclaimer />\n                  </>\n                </Media>\n              </Flex>\n            }\n          />\n        </HorizontalPadding>\n      </>\n    )\n  }\n}\n\nexport const RejectFragmentContainer = createFragmentContainer(\n  trackPageViewWrapper(injectCommitMutation(injectDialog(Reject))),\n  {\n    order: graphql`\n      fragment Reject_order on CommerceOrder {\n        id\n        stateExpiresAt\n        lineItems {\n          edges {\n            node {\n              artwork {\n                id\n              }\n            }\n          }\n        }\n        ... on CommerceOfferOrder {\n          lastOffer {\n            id\n            createdAt\n          }\n        }\n        ...ArtworkSummaryItem_order\n      }\n    `,\n  }\n)\n"],"file":"index.js"}