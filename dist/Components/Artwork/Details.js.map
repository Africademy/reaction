{"version":3,"sources":["../../../src/Components/Artwork/Details.tsx"],"names":["TruncatedLine","styled","div","Details","props","artwork","cultural_maker","artists","includeLinks","length","artistLine","reduce","acc","artist","index","concat","link","name","href","__id","slice","artworkText","title","date","artworkTextWithLink","text","key","collecting_institution","line","partner","hasSaleMessage","sale_message","notInAuction","sale","is_auction","display","saleMessage","bidInfo","inRunningAuction","is_closed","undefined","bidderPositionCounts","a","sale_artwork","counts","bidder_positions","s","isAuction","showBiddingClosed","highestBidDisplay","p","highest_bid","openingBidDisplay","opening_bid","user","saleInfoLine","titleLine","partnerLine","React","Component","showSaleLine","DetailsFragmentContainer"],"mappings":"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","sourcesContent":["import { color, Sans, Spacer } from \"@artsy/palette\"\nimport { Details_artwork } from \"__generated__/Details_artwork.graphql\"\nimport { SystemContextConsumer } from \"Artsy\"\nimport React from \"react\"\n// @ts-ignore\nimport { ComponentRef, createFragmentContainer, graphql } from \"react-relay\"\nimport styled from \"styled-components\"\nimport { get } from \"Utils/get\"\nimport TextLink from \"../TextLink\"\n\nconst TruncatedLine = styled.div`\n  display: block;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n`\n\nexport interface Props extends React.HTMLProps<Details> {\n  showSaleLine: boolean\n  includeLinks: boolean\n  artwork: Details_artwork\n}\n\nexport class Details extends React.Component<Props, null> {\n  static defaultProps = {\n    showSaleLine: true,\n    includeLinks: true,\n  }\n\n  artistLine() {\n    const { cultural_maker, artists } = this.props.artwork\n    const { includeLinks } = this.props\n\n    if (cultural_maker) {\n      return (\n        <TruncatedLine>\n          <strong>{cultural_maker}</strong>\n        </TruncatedLine>\n      )\n    } else if (artists && artists.length) {\n      const artistLine = artists\n        .reduce((acc, artist, index) => {\n          return acc.concat([\n            \", \",\n            includeLinks\n              ? this.link(artist.name, artist.href, artist.__id + \"-\" + index)\n              : artist.name,\n          ])\n        }, [])\n        .slice(1)\n      return (\n        <TruncatedLine>\n          <strong>{artistLine}</strong>\n        </TruncatedLine>\n      )\n    }\n  }\n\n  titleLine() {\n    const { includeLinks } = this.props\n    const artworkText = (\n      <>\n        <em>{this.props.artwork.title}</em>\n        {this.props.artwork.date && `, ${this.props.artwork.date}`}\n      </>\n    )\n    const artworkTextWithLink = includeLinks ? (\n      <TextLink href={this.props.artwork.href}>{artworkText}</TextLink>\n    ) : (\n      artworkText\n    )\n    return <TruncatedLine>{artworkTextWithLink}</TruncatedLine>\n  }\n\n  line(text) {\n    return <TruncatedLine>{text}</TruncatedLine>\n  }\n\n  link(text, href, key) {\n    return (\n      <TextLink href={href} key={key}>\n        {text}\n      </TextLink>\n    )\n  }\n\n  partnerLine() {\n    if (this.props.artwork.collecting_institution) {\n      return this.line(this.props.artwork.collecting_institution)\n    } else if (this.props.artwork.partner) {\n      if (this.props.includeLinks) {\n        return (\n          <TruncatedLine>\n            <TextLink href={this.props.artwork.partner.href}>\n              {this.props.artwork.partner.name}\n            </TextLink>\n          </TruncatedLine>\n        )\n      } else {\n        return this.line(this.props.artwork.partner.name)\n      }\n    }\n  }\n\n  saleLine() {\n    const artwork = this.props.artwork\n    const hasSaleMessage =\n      artwork.sale_message && artwork.sale_message !== \"Contact For Price\"\n    const notInAuction = !(artwork.sale && artwork.sale.is_auction)\n    if (hasSaleMessage && notInAuction) {\n      return <div>{artwork.sale_message}</div>\n    }\n  }\n\n  saleInfoLine() {\n    return (\n      <>\n        <Sans\n          style={{ display: \"inline\" }}\n          color={color(\"black100\")}\n          weight={\"medium\"}\n          size={\"2\"}\n        >\n          {this.saleMessage()}{\" \"}\n        </Sans>\n        <Sans\n          style={{ display: \"inline\" }}\n          size={\"2\"}\n          color={color(\"black100\")}\n          weight={\"regular\"}\n        >\n          {this.bidInfo()}\n        </Sans>\n        <Spacer mb={0.3} />\n      </>\n    )\n  }\n\n  bidInfo() {\n    const { artwork } = this.props\n    const { sale } = this.props.artwork\n\n    const inRunningAuction = sale && sale.is_auction && !sale.is_closed\n    if (!inRunningAuction) {\n      return undefined\n    }\n\n    const bidderPositionCounts = get(\n      artwork,\n      a => a.sale_artwork.counts.bidder_positions,\n      0\n    )\n\n    if (bidderPositionCounts === 0) {\n      return undefined\n    }\n\n    const s = bidderPositionCounts > 1 ? \"s\" : \"\"\n    return `(${bidderPositionCounts} bid${s})`\n  }\n\n  saleMessage() {\n    const { artwork } = this.props\n    const { sale } = artwork\n    const isAuction = sale && sale.is_auction\n\n    if (isAuction) {\n      const showBiddingClosed = sale.is_closed\n      if (showBiddingClosed) {\n        return \"Bidding closed\"\n      } else {\n        const highestBidDisplay = get(\n          artwork,\n          p => p.sale_artwork.highest_bid.display\n        )\n        const openingBidDisplay = get(\n          artwork,\n          p => p.sale_artwork.opening_bid.display\n        )\n\n        return highestBidDisplay || openingBidDisplay || \"\"\n      }\n    }\n\n    // TODO: Extract this sentence-cased version and apply everywhere.\n    if (artwork.sale_message === \"Contact For Price\") {\n      return \"Contact for price\"\n    }\n\n    return artwork.sale_message\n  }\n\n  render() {\n    return (\n      <SystemContextConsumer>\n        {({ user }) => {\n          return (\n            <div>\n              {this.saleInfoLine()}\n              {this.artistLine()}\n              {this.titleLine()}\n              {this.partnerLine()}\n            </div>\n          )\n        }}\n      </SystemContextConsumer>\n    )\n  }\n}\n\nexport const DetailsFragmentContainer = createFragmentContainer<Props>(\n  Details,\n  {\n    artwork: graphql`\n      fragment Details_artwork on Artwork {\n        href\n        title\n        date\n        sale_message\n        cultural_maker\n        artists(shallow: true) {\n          __id\n          href\n          name\n        }\n        collecting_institution\n        partner(shallow: true) {\n          name\n          href\n        }\n        sale {\n          is_auction\n          is_closed\n        }\n        sale_artwork {\n          counts {\n            bidder_positions\n          }\n          highest_bid {\n            display\n          }\n          opening_bid {\n            display\n          }\n        }\n      }\n    `,\n  }\n)\n"],"file":"Details.js"}