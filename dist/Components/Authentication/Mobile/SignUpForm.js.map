{"version":3,"sources":["../../../../src/Components/Authentication/Mobile/SignUpForm.tsx"],"names":["currentStepActionName","Schema","ActionName","EmailNextButton","PasswordNextButton","TrackedMobileSignUpForm","props","state","args","action_type","ActionType","Click","action_name","contextModule","flow","subject","intent","isSocialSignUp","status","error","success","values","formikBag","recaptcha_token","valuesWithToken","handleSubmit","currentStepIndex","steps","MobileSignUpValidator","email","actions","relayEnvironment","shouldExist","wizard","form","errors","handleChange","handleBlur","setTouched","accepted_terms_of_service","password","name","onSubmit","context","isSubmitting","currentStep","isLastStep","progressPercentage","e","onBackButtonClicked","previous","title","showError","shouldAllowNext","trackNextClick","setState","onFacebookLogin","handleTypeChange","showRecaptchaDisclaimer","Component","MobileSignUpForm"],"mappings":"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","sourcesContent":["import { withSystemContext } from \"Artsy\"\nimport { track } from \"Artsy/Analytics\"\nimport * as Schema from \"Artsy/Analytics/Schema\"\nimport {\n  BackButton,\n  Error,\n  Footer,\n  MobileContainer,\n  MobileHeader,\n  MobileInnerWrapper,\n  SubmitButton,\n  TermsOfServiceCheckbox,\n} from \"Components/Authentication/commonElements\"\nimport { checkEmail } from \"Components/Authentication/helpers\"\nimport {\n  FormProps,\n  InputValues,\n  ModalType,\n} from \"Components/Authentication/Types\"\nimport { MobileSignUpValidator } from \"Components/Authentication/Validators\"\nimport Icon from \"Components/Icon\"\nimport PasswordInput from \"Components/PasswordInput\"\nimport { ProgressIndicator } from \"Components/ProgressIndicator\"\nimport QuickInput from \"Components/QuickInput\"\nimport { Step, Wizard } from \"Components/Wizard\"\nimport { FormikProps } from \"formik\"\nimport React, { Component, Fragment } from \"react\"\nimport { Environment } from \"relay-runtime\"\nimport { repcaptcha } from \"Utils/repcaptcha\"\n\nexport interface MobileSignUpFormState {\n  isSocialSignUp: boolean\n}\n\nexport const currentStepActionName = {\n  0: Schema.ActionName.EmailNextButton,\n  1: Schema.ActionName.PasswordNextButton,\n}\n\n@track()\nclass TrackedMobileSignUpForm extends Component<\n  FormProps & {\n    relayEnvironment: Environment\n  },\n  MobileSignUpFormState\n> {\n  state = {\n    isSocialSignUp: false,\n  }\n\n  @track((props: { contextModule: string; intent: string }, state, args) => ({\n    action_type: Schema.ActionType.Click,\n    action_name: currentStepActionName[args[0]],\n    contextModule: args[1],\n    flow: \"auth\",\n    subject: \"clicked next button\",\n    intent: props.intent,\n  }))\n  trackNextClick(currentStepIndex, contextModule) {\n    // no op\n  }\n\n  showError = status => {\n    const { error } = this.props\n    if (error) {\n      return <Error show>{error}</Error>\n    }\n\n    if (status && !status.success) {\n      return <Error show>{status.error}</Error>\n    }\n\n    return null\n  }\n\n  onSubmit = (values: InputValues, formikBag: FormikProps<InputValues>) => {\n    repcaptcha(\"signup_submit\", recaptcha_token => {\n      const valuesWithToken = {\n        ...values,\n        recaptcha_token,\n      }\n      this.props.handleSubmit(valuesWithToken, formikBag)\n    })\n  }\n\n  render() {\n    const steps = [\n      <Step\n        validationSchema={MobileSignUpValidator.email}\n        onSubmit={(values, actions) =>\n          checkEmail({\n            relayEnvironment: this.props.relayEnvironment,\n            values,\n            actions,\n            shouldExist: false,\n          })\n        }\n      >\n        {({\n          wizard,\n          form: { errors, values, handleChange, handleBlur, setTouched },\n        }) => (\n          <Fragment>\n            <QuickInput\n              block\n              error={!this.state.isSocialSignUp && errors.email}\n              placeholder=\"Enter your email address\"\n              name=\"email\"\n              label=\"Email\"\n              type=\"email\"\n              value={values.email}\n              onChange={handleChange}\n              onBlur={handleBlur}\n              setTouched={setTouched}\n              touchedOnChange={false}\n              autoFocus\n            />\n            <TermsOfServiceCheckbox\n              error={errors.accepted_terms_of_service}\n              checked={values.accepted_terms_of_service}\n              value={values.accepted_terms_of_service}\n              type=\"checkbox\"\n              name=\"accepted_terms_of_service\"\n              onChange={handleChange}\n              onBlur={handleBlur}\n            />\n          </Fragment>\n        )}\n      </Step>,\n      <Step validationSchema={MobileSignUpValidator.password}>\n        {({\n          wizard,\n          form: { errors, values, handleChange, handleBlur, setTouched },\n        }) => (\n          <PasswordInput\n            block\n            error={errors.password}\n            name=\"password\"\n            label=\"Password\"\n            placeholder=\"Password\"\n            value={values.password}\n            onChange={handleChange}\n            onBlur={handleBlur}\n            setTouched={setTouched}\n            touchedOnChange={false}\n            showPasswordMessage\n          />\n        )}\n      </Step>,\n      <Step validationSchema={MobileSignUpValidator.name}>\n        {({\n          wizard,\n          form: { errors, values, handleChange, handleBlur, setTouched },\n        }) => (\n          <QuickInput\n            block\n            error={errors.name}\n            name=\"name\"\n            label=\"Name\"\n            placeholder=\"Name\"\n            type=\"text\"\n            value={values.name}\n            onChange={handleChange}\n            onBlur={handleBlur}\n            setTouched={setTouched}\n            touchedOnChange={false}\n          />\n        )}\n      </Step>,\n    ]\n\n    return (\n      <Wizard steps={steps} onComplete={this.onSubmit}>\n        {context => {\n          const {\n            form: { handleSubmit, values, setTouched, isSubmitting, status },\n            wizard,\n          } = context\n          const { currentStep, isLastStep } = wizard\n\n          return (\n            <MobileContainer>\n              <ProgressIndicator percentComplete={wizard.progressPercentage} />\n              <MobileInnerWrapper>\n                <BackButton\n                  onClick={e =>\n                    this.props.onBackButtonClicked &&\n                    wizard.currentStepIndex === 0\n                      ? this.props.onBackButtonClicked(e as any)\n                      : wizard.previous(e, values)\n                  }\n                >\n                  <Icon name=\"chevron-left\" color=\"black60\" fontSize=\"16px\" />\n                </BackButton>\n                <MobileHeader>\n                  {this.props.title || \"Sign up for Artsy\"}\n                </MobileHeader>\n                {currentStep}\n                {this.showError(status)}\n                <SubmitButton\n                  onClick={e => {\n                    if (wizard.shouldAllowNext && this.props.contextModule) {\n                      this.trackNextClick(\n                        wizard.currentStepIndex,\n                        this.props.contextModule\n                      )\n                    }\n\n                    this.setState(\n                      {\n                        isSocialSignUp: false,\n                      },\n                      () => {\n                        handleSubmit(e)\n                      }\n                    )\n                  }}\n                  loading={isLastStep && isSubmitting}\n                >\n                  {isLastStep ? \"Create account\" : \"Next\"}\n                </SubmitButton>\n                <Footer\n                  mode={\"signup\" as ModalType}\n                  onFacebookLogin={e => {\n                    if (!values.accepted_terms_of_service) {\n                      this.setState(\n                        {\n                          isSocialSignUp: true,\n                        },\n                        () => {\n                          setTouched({\n                            accepted_terms_of_service: true,\n                          })\n                        }\n                      )\n                    } else {\n                      if (this.props.onFacebookLogin) {\n                        this.props.onFacebookLogin(e)\n                      }\n                    }\n                  }}\n                  handleTypeChange={this.props.handleTypeChange}\n                  showRecaptchaDisclaimer={this.props.showRecaptchaDisclaimer}\n                />\n              </MobileInnerWrapper>\n            </MobileContainer>\n          )\n        }}\n      </Wizard>\n    )\n  }\n}\n\nexport const MobileSignUpForm = withSystemContext(TrackedMobileSignUpForm)\n"],"file":"SignUpForm.js"}