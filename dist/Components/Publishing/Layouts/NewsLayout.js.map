{"version":3,"sources":["../../../../src/Components/Publishing/Layouts/NewsLayout.tsx"],"names":["NewsLayout","props","article","tracking","trackEvent","action","pathname","slug","state","isTruncated","isHovered","onExpand","bind","trackExpand","nextProps","setState","articleSerial","isMobile","AdUnit","Mobile_NewsLanding_InContent1","Desktop_NewsLanding_Leaderboard1","Mobile_NewsLanding_InContent2","Desktop_NewsLanding_Leaderboard2","Mobile_NewsLanding_InContent3","Desktop_NewsLanding_LeaderboardRepeat","relatedArticlesForCanvas","showCollectionsRail","shouldAdRender","adUnit","getAdUnit","adDimension","AdDimension","renderFooterContent","Component","NewsContainer","styled","div","CanvasFooterContainer","ExpandButton","button","pMedia","sm","NewsArticleContainer","marginTop"],"mappings":"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","sourcesContent":["import { color } from \"@artsy/palette\"\nimport { unica } from \"Assets/Fonts\"\nimport { targetingData } from \"Components/Publishing/Display/DisplayTargeting\"\nimport { once } from \"lodash\"\nimport React, { Component } from \"react\"\nimport track, { TrackingProp } from \"react-tracking\"\nimport styled from \"styled-components\"\nimport { pMedia } from \"../../Helpers\"\nimport { DisplayAd } from \"../Display/DisplayAd\"\nimport { NewsHeadline } from \"../News/NewsHeadline\"\nimport { NewsSections } from \"../News/NewsSections\"\nimport {\n  AdDimension,\n  AdUnit,\n  ArticleData,\n  RelatedArticleCanvasData,\n} from \"../Typings\"\nimport { CanvasFooter, CanvasFooterContainer } from \"./Components/CanvasFooter\"\n\ninterface Props {\n  article: ArticleData\n  articleSerial?: number\n  isMobile?: boolean\n  isHovered?: boolean\n  isTruncated?: boolean\n  onExpand?: () => void\n  relatedArticlesForCanvas?: RelatedArticleCanvasData[]\n  showCollectionsRail?: boolean\n  tracking?: TrackingProp\n  shouldAdRender?: boolean\n}\n\ninterface State {\n  isTruncated: boolean\n  isHovered: boolean\n}\n\ninterface NewsContainerProps {\n  isTruncated: boolean\n  marginTop?: string\n  isHovered: boolean\n}\n\n@track()\nexport class NewsLayout extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n\n    this.state = {\n      isTruncated: this.props.isTruncated || false,\n      isHovered: this.props.isHovered || false,\n    }\n\n    this.onExpand = this.onExpand.bind(this)\n    this.trackExpand = once(this.trackExpand)\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.isHovered !== this.props.isHovered) {\n      this.setState({ isHovered: nextProps.isHovered })\n    }\n  }\n\n  onExpand() {\n    const { onExpand } = this.props\n    this.trackExpand()\n    if (onExpand) {\n      onExpand()\n    }\n    this.setState({ isTruncated: false })\n  }\n\n  trackExpand = () => {\n    const { article, tracking } = this.props\n    if (tracking) {\n      tracking.trackEvent({\n        action: \"Clicked read more\",\n        pathname: `/news/${article.slug}`,\n      })\n    }\n  }\n  /**\n   * Ad unit code \"Mobile/Desktop_InContentLB1\" is for ads that appear after the 3rd article,\n   * \"<Mobile/Desktop_InContentLB2\" for ads that appear after the 9th article,\n   * and Mobile/Desktop_InContentLBRepeat is for all subsequent ads\n   */\n  getAdUnit() {\n    const { articleSerial, isMobile } = this.props\n\n    if (articleSerial === 3) {\n      return isMobile\n        ? AdUnit.Mobile_NewsLanding_InContent1\n        : AdUnit.Desktop_NewsLanding_Leaderboard1\n    }\n    if (articleSerial === 9) {\n      return isMobile\n        ? AdUnit.Mobile_NewsLanding_InContent2\n        : AdUnit.Desktop_NewsLanding_Leaderboard2\n    }\n    return isMobile\n      ? AdUnit.Mobile_NewsLanding_InContent3\n      : AdUnit.Desktop_NewsLanding_LeaderboardRepeat\n  }\n\n  renderFooterContent() {\n    const {\n      isMobile,\n      article,\n      relatedArticlesForCanvas,\n      showCollectionsRail,\n      shouldAdRender,\n    } = this.props\n    const adUnit = this.getAdUnit()\n    const adDimension = isMobile\n      ? AdDimension.Mobile_NewsLanding_InContent1\n      : AdDimension.Desktop_NewsLanding_Leaderboard1\n\n    return (\n      <>\n        {shouldAdRender && (\n          <DisplayAd\n            adUnit={adUnit}\n            adDimension={adDimension}\n            targetingData={targetingData(article, \"newslanding\")}\n          />\n        )}\n        {relatedArticlesForCanvas && (\n          <CanvasFooter\n            article={article}\n            relatedArticles={relatedArticlesForCanvas}\n            showCollectionsRail={showCollectionsRail}\n          />\n        )}\n      </>\n    )\n  }\n\n  render() {\n    const { article, isMobile } = this.props\n    const { isTruncated, isHovered } = this.state\n\n    return (\n      <NewsContainer>\n        <NewsArticleContainer\n          isTruncated={isTruncated}\n          isHovered={isHovered}\n          onClick={() => {\n            if (isTruncated) {\n              this.onExpand()\n            }\n          }}\n          onMouseEnter={() => {\n            if (!isMobile) {\n              this.setState({ isHovered: true })\n            }\n          }}\n          onMouseLeave={() => {\n            if (!isMobile) {\n              this.setState({ isHovered: false })\n            }\n          }}\n        >\n          <NewsHeadline article={article} />\n          <NewsSections {...this.props} isTruncated={isTruncated} />\n          <ExpandButton\n            isHovered={isHovered}\n            isTruncated={isTruncated}\n            onClick={this.onExpand}\n          >\n            Expand\n          </ExpandButton>\n        </NewsArticleContainer>\n\n        {this.renderFooterContent()}\n      </NewsContainer>\n    )\n  }\n}\nconst NewsContainer = styled.div`\n  ${CanvasFooterContainer} {\n    border-bottom: 1px solid ${color(\"black10\")};\n  }\n`\n\nexport const ExpandButton = styled.button`\n  width: 80px;\n  height: 30px;\n  background-color: black;\n  position: absolute;\n  bottom: 30px;\n  right: 30px;\n  color: white;\n  border-radius: 2px;\n  border: none;\n  display: block;\n  opacity: 0;\n  cursor: pointer;\n  padding: 0;\n  transition: opacity 0.25s ease;\n  ${unica(\"s14\", \"medium\")};\n  line-height: 1em;\n\n  &:focus {\n    outline: 0;\n  }\n\n  &:hover {\n    color: ${color(\"black10\")};\n  }\n\n  ${(props: NewsContainerProps) =>\n    props.isHovered &&\n    props.isTruncated &&\n    `\n      opacity: 1;\n    `};\n\n  ${pMedia.sm`\n    bottom: 15px;\n    right: 15px;\n  `};\n`\n\nexport const NewsArticleContainer = styled.div`\n  position: relative;\n  max-width: 780px;\n  padding: 20px 30px 30px;\n  margin: 40px auto;\n  transition: all 0.25s ease;\n  border: 1px solid transparent;\n\n  ${(props: NewsContainerProps) =>\n    props.marginTop &&\n    `\n    margin-top: ${props.marginTop};\n  `};\n\n  ${(props: NewsContainerProps) =>\n    props.isTruncated &&\n    props.isHovered &&\n    `\n    border-radius: 4px;\n    border: 1px solid ${color(\"black10\")};\n    cursor: pointer;\n  `};\n\n  ${pMedia.sm`\n    margin: 40px 5px;\n    padding: 10px 15px 20px;\n    ${(props: NewsContainerProps) =>\n      props.marginTop &&\n      `\n      margin-top: ${props.marginTop};\n    `};\n  `};\n`\n"],"file":"NewsLayout.js"}